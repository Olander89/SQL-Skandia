USE [MART]
GO

CREATE TABLE [MART].[dbo].[Grunddata_Bolån] (
	  [RapportDatum] DATETIME NULL,
	  [Huvudlåntagare ID] VARCHAR(100) NULL,
	  [Medlåntagare 1 ID] VARCHAR(100) NULL,
	  [Medlåntagare 2 ID] VARCHAR(100) NULL,
	  [Kund land] VARCHAR(100) NULL,
	  [Kund län] VARCHAR(100) NULL,
	  [Kund kommun] VARCHAR(100) NULL,
	  [Kund postnr] VARCHAR(100) NULL,
	  [Anställd i Skb] VARCHAR(100) NULL,
	  [Sektorkod] VARCHAR(100) NULL,
	  [Internt kredtitbetyg] VARCHAR(100) NULL,
	  [Internt kreditbetyg datum] VARCHAR(100) NULL,							
	  [Lånekontonummer] VARCHAR(100) NULL,
	  [Lånedel] VARCHAR(100) NULL,							
	  [Valbar lag] VARCHAR(100) NULL,
	  [Valbar skb] VARCHAR(100) NULL,
	  [Ingår i pool] VARCHAR(100) NULL,
	  [Produkttyp] VARCHAR(100) NULL,
	  [Lånesyfte] VARCHAR(100) NULL,
	  [Valuta] VARCHAR(100) NULL,
	  [Utbetalningsdatumlån] VARCHAR(100) NULL,
	  [Utbetalningsdatum lånedel] VARCHAR(100) NULL,
	  [Omsättningsdatum] VARCHAR(100) NULL,
	  [Förfallodatum] VARCHAR(100) NULL,
	  [LåneÅlderMånad] VARCHAR(100) NULL,
	  [LånedelÅlderMånad] VARCHAR(100) NULL,
	  [Tid till omsättningsdatum, månader] VARCHAR(100) NULL,
	  [Återstående löptid lån, månader] VARCHAR(100) NULL,
	  [Återstående löptid lånedel, månader] VARCHAR(100) NULL,
	  [Räntetyp] VARCHAR(100) NULL,
	  [Räntebetalningar per år] VARCHAR(100) NULL,
	  [Bundet från] VARCHAR(100) NULL,
	  [Bundet till] VARCHAR(100) NULL,
	  [Räntesats] VARCHAR(100) NULL,
	  [Marginal] VARCHAR(100) NULL,
	  [Amorteringsprofil] VARCHAR(100) NULL,
	  [Amortering per år] VARCHAR(100) NULL,
	  [AmorteringDatum]  VARCHAR(100) NULL,
	  [Missade betalningar två månader i rad] VARCHAR(100) NULL,
	  [Betalning försenad, dagar] VARCHAR(100) NULL,
	  [Reservering belopp] VARCHAR(100) NULL,
	  [Reservering status] VARCHAR(100) NULL,
	  [Borgensbelopp per lån] VARCHAR(100) NULL,
	  [Andel av säkerhetens skuld] VARCHAR(100) NULL,
	  [Utbetalt belopp] VARCHAR(100) NULL,
	  [Aktuell skuld] VARCHAR(100) NULL,
	  [Poolbelopp] VARCHAR(100) NULL,
	  [NV Kassaflöde +0bp] VARCHAR(100) NULL,
	  [NV Kassaflöde +100bp] VARCHAR(100) NULL,
	  [NV Kassaflöde -100bp] VARCHAR(100) NULL,
	  [NV Kassaflöde kurvbrantning] VARCHAR(100) NULL,
	  [NV Kassaflöde kurvflackning] VARCHAR(100) NULL,
	  [NV Poolbelopp +0bp] VARCHAR(100) NULL,
	  [NV Poolbelopp +100bp] VARCHAR(100) NULL,
	  [NV Poolbelopp -100bp] VARCHAR(100) NULL,
	  [NV Poolbelopp kurvbrantning] VARCHAR(100) NULL,
	  [NV Poolbelopp kurvflackning] VARCHAR(100) NULL,
	  [Säkerhet ID] VARCHAR(100) NULL,
	  [Säkerhet namn] VARCHAR(100) NULL,
	  [Säkerhet land] VARCHAR(100) NULL,
	  [Säkerhet län] VARCHAR(100) NULL,
	  [Säkerhet länskod] VARCHAR(100) NULL,
	  [Säkerhet kommun] VARCHAR(100) NULL,
	  [Säkerhet kommunkod] VARCHAR(100) NULL,
	  [Säkerhet postnr] VARCHAR(100) NULL,
	  [Fastighetstyp namn] VARCHAR(100) NULL,
	  [Fastighetstyp kod] VARCHAR(100) NULL,
	  [Indexerat, säkerhetsvärde] VARCHAR(100) NULL,
	  [Indexerat, värderingskälla] VARCHAR(100) NULL,
	  [Indexerat, värderingsdatum] VARCHAR(100) NULL,
	  [Indexerat, belåningsgrad] VARCHAR(100) NULL,
	  [Oindexerat, säkerhetsvärde] VARCHAR(100) NULL,
	  [Oindexerat, värderingskälla] VARCHAR(100) NULL,
	  [Oindexerat, värderingsdatum] VARCHAR(100) NULL,
	  [Oindexerat, belåningsgrad] VARCHAR(100) NULL,
	  [Initialt, säkerhetsvärde] VARCHAR(100) NULL,
	  [Initialt, värderingskälla] VARCHAR(100) NULL,
	  [Initialt, värderingsdatum] VARCHAR(100) NULL,
	  [Initialt, belåningsgrad] VARCHAR(100) NULL,
	  [Taxeringsvärde] VARCHAR(100) NULL,
	  [Taxeringsår] VARCHAR(100) NULL,
	  [Glapp i pantbrev per säkerhet] VARCHAR(100) NULL,
	  [Pantsatt skuld per säkerhet] VARCHAR(100) NULL,
	  [Blancoskuld per säkerhet] VARCHAR(100) NULL,
	  [Kunds andel av BRFs skuld per säkerhet] VARCHAR(100) NULL,
	  [I05 per säkerhet] VARCHAR(100) NULL,
	  [I10 per säkerhet] VARCHAR(100) NULL,
	  [I15 per säkerhet] VARCHAR(100) NULL,
	  [I20 per säkerhet] VARCHAR(100) NULL,
	  [I25 per säkerhet] VARCHAR(100) NULL,
	  [I30 per säkerhet] VARCHAR(100) NULL,
	  [I35 per säkerhet] VARCHAR(100) NULL,
	  [I40 per säkerhet] VARCHAR(100) NULL,
	  [I45 per säkerhet] VARCHAR(100) NULL,
	  [I50 per säkerhet] VARCHAR(100) NULL,
	  [I55 per säkerhet] VARCHAR(100) NULL,
	  [I60 per säkerhet] VARCHAR(100) NULL,
	  [I65 per säkerhet] VARCHAR(100) NULL,
	  [I70 per säkerhet] VARCHAR(100) NULL,
	  [I75 per säkerhet] VARCHAR(100) NULL,
	  [I80 per säkerhet] VARCHAR(100) NULL,
	  [I85 per säkerhet] VARCHAR(100) NULL,
	  [I90 per säkerhet] VARCHAR(100) NULL,
	  [I95 per säkerhet] VARCHAR(100) NULL,
	  [I100 per säkerhet] VARCHAR(100) NULL,
	  [I100Plus per säkerhet] VARCHAR(100) NULL,
	  [SenasteMånadsladdning] VARCHAR(100) NULL,
	  [PrisfallProcent] VARCHAR(100) NULL,
	  [StressUtfördDatum] VARCHAR(100) NULL,
	  [Indexerat,Säkerhetsvärde (justerat)] VARCHAR(100) NULL,
	  [Indexerat,Belåningsgrad (justerat)] VARCHAR(100) NULL,
	  [Indexerat,Poolbelopp (justerat)] VARCHAR(100) NULL,
	  [Indexerat,Nuvärde Poolbelopp (justerat)] VARCHAR(100) NULL,
	  [Indexerat_säkerhetsvärde_minus5] VARCHAR(100) NULL,
	  [Indexerat_säkerhetsvärde_minus10] VARCHAR(100) NULL,
	  [Indexerat_säkerhetsvärde_minus15] VARCHAR(100) NULL,
	  [Indexerat_säkerhetsvärde_minus20] VARCHAR(100) NULL,
	  [Indexerat_säkerhetsvärde_minus25] VARCHAR(100) NULL,
	  [Indexerat_säkerhetsvärde_minus30] VARCHAR(100) NULL,
	  [Indexerat_Belåningsgrad_minus5] VARCHAR(100) NULL,
	  [Indexerat_Belåningsgrad_minus10] VARCHAR(100) NULL,
	  [Indexerat_Belåningsgrad_minus15] VARCHAR(100) NULL,
	  [Indexerat_Belåningsgrad_minus20] VARCHAR(100) NULL,
	  [Indexerat_Belåningsgrad_minus25] VARCHAR(100) NULL,
	  [Indexerat_Belåningsgrad_minus30] VARCHAR(100) NULL,
	  [Poolbelopp_minus5] VARCHAR(100) NULL,
	  [Poolbelopp_minus10] VARCHAR(100) NULL,
	  [Poolbelopp_minus15] VARCHAR(100) NULL,
	  [Poolbelopp_minus20] VARCHAR(100) NULL,
	  [Poolbelopp_minus25] VARCHAR(100) NULL,
	  [Poolbelopp_minus30] VARCHAR(100) NULL,
	  [NVPoolBelopp_minus5] VARCHAR(100) NULL,
	  [NVPoolBelopp_minus10] VARCHAR(100) NULL,
	  [NVPoolBelopp_minus15] VARCHAR(100) NULL,
	  [NVPoolBelopp_minus20] VARCHAR(100) NULL,
	  [NVPoolBelopp_minus25] VARCHAR(100) NULL,
	  [NVPoolBelopp_minus30] VARCHAR(100) NULL,
	  [ValbarSKBKod] VARCHAR(100) NULL,
	  [AmorteringBeloppMånad] VARCHAR(100) NULL);

INSERT INTO [MART].[dbo].[Grunddata_Bolån]
EXEC	[ssrs].[usp_Lån_CB_Grunddata_inkl_Stress_rpt]
		@snapshotDatum = N'2020-10-12',
		@landkod = N'SE',
		@SäkerhetLän = N'ALLA',
		@SäkerhetKommun = N'ALLA',
		@SäkerhetFastighetstyp = N'ALLA',
		@PrisfallProcent = 50,
		@Urval = 1,
		@Lånekontonummer = NULL,
		@Säkerhet = NULL

ALTER TABLE [MART].[dbo].[Grunddata_Bolån]
ADD LoadDate DATETIME

UPDATE [MART].[dbo].[Grunddata_Bolån]
SET LoadDate = Getdate()
WHERE LoadDate IS NULL

DROP TABLE [MART].[dbo].[Grunddata_Bolån]

GO

